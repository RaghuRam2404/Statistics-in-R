load("/Users/raghu-2264/Documents/Statistics with R - Coursera/Course 5 - Capestone Project/Week 5/ames_train.Rdata")
ames_train <- ames_train %>% mutate(lprice=log(price), larea=log(area), llarea=log(Lot.Area))
library(MASS)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(BAS)
ames_train <- ames_train %>% mutate(lprice=log(price), larea=log(area), llarea=log(Lot.Area))
model = lm(lprice ~ larea + llarea + Bedroom.AbvGr + Overall.Qual + Land.Slope)
model = lm(lprice ~ larea + llarea + Bedroom.AbvGr + Overall.Qual + Land.Slope, data=ames_train)
AIC(model)
123
AIC(lm(lprice ~ llarea + Bedroom.AbvGr + Overall.Qual + Land.Slope, data=ames_train))
AIC(lm(lprice ~ larea + Bedroom.AbvGr + Overall.Qual + Land.Slope, data=ames_train))
AIC(lm(lprice ~ larea + llarea + Overall.Qual + Land.Slope, data=ames_train))
AIC(lm(lprice ~ larea + llarea + Bedroom.AbvGr + Land.Slope, data=ames_train))
AIC(lm(lprice ~ larea + llarea + Bedroom.AbvGr + Overall.Qual, data=ames_train))
123
BIC(lm(lprice ~ llarea + Bedroom.AbvGr + Overall.Qual + Land.Slope, data=ames_train))
BIC(lm(lprice ~ larea + Bedroom.AbvGr + Overall.Qual + Land.Slope, data=ames_train))
BIC(lm(lprice ~ larea + llarea + Overall.Qual + Land.Slope, data=ames_train))
BIC(lm(lprice ~ larea + llarea + Bedroom.AbvGr + Land.Slope, data=ames_train))
BIC(lm(lprice ~ larea + llarea + Bedroom.AbvGr + Overall.Qual, data=ames_train))
BIC(model)
model1 <- lm(lprice ~ Bedroom.AbvGr)
model2 <- lm(lprice ~ Bedroom.AbvGr + larea)
model1 <- lm(lprice ~ Bedroom.AbvGr, data=ames_train)
model2 <- lm(lprice ~ Bedroom.AbvGr + larea, data=ames_train)
model1
model2
summary(model1)
summary(model2)
model3 <- lm(lprice ~ larea)
model3 <- lm(lprice ~ larea, data=ames_train)
model3$fitted.values
model3$residuals
model3 <- lm(lprice ~ larea, data=ames_train)
ames_train$model3_residuals <- model3$residuals
ames_train
ames_train %>% group_by(Neighborhood) %>% summarise(avg = mean(model3_residuals)) %>% arrange(desc(TRUE))
ames_train %>% group_by(Neighborhood) %>% summarise(avg = mean(model3_residuals)) %>% arrange(desc())
ames_train %>% group_by(Neighborhood) %>% summarise(avg = mean(model3_residuals)) %>% arrange()
ames_train %>% group_by(Neighborhood) %>% summarise(avg = mean(model3_residuals)) %>% arrange(desc(true))
ames_train %>% group_by(Neighborhood) %>% summarise(avg = mean(model3_residuals)) %>% arrange(desc(TRUE))
ames_train %>% group_by(Neighborhood) %>% summarise(avg = mean(model3_residuals)) %>% arrange(desc(avg))
ames_train <- ames_train %>% mutate(model3_residuals_squared <- model3_residuals*model3_residuals)
ames_train <- ames_train %>% mutate(model3_residuals_squared = model3_residuals*model3_residuals)
ames_train %>% group_by(Neighborhood) %>% summarise(avg = mean(model3_residuals_squared)) %>% arrange(desc(avg))
lm(data = ames_train, lprice ~ Overall.Qual + basement.Qual + Garage.Qual)
lm(lprice ~ Overall.Qual + basement.Qual + Garage.Qual, data = ames_train)
lm(lprice ~ Overall.Qual + Basement.Qual + Garage.Qual, data = ames_train)
lm(lprice ~ Overall.Qual + Garage.Qual, data = ames_train)
lm(lprice ~ Overall.Qual + Garage.Qual + Bsmt.Qual, data = ames_train)
na.omit(ames_train, cols=c("Bsmt.Qual", "Garage.Qual", "Overall.Qual"))
ames_train %>% group_by(Bsmt.Qual) %>% summary(n=n())
ames_train %>% group_by(Bsmt.Qual) %>% summarise(n=n())
ames_train %>% filter(is.na(Overall.Qual) | is.na(Basement.Qual) | is.na(Garage.Qual))
ames_train %>% filter(is.na(Overall.Qual) | is.na(Bsmt.Qual) | is.na(Garage.Qual))
dim(ames_train %>% filter(is.na(Overall.Qual) | is.na(Bsmt.Qual) | is.na(Garage.Qual)))[0]
dim(ames_train %>% filter(is.na(Overall.Qual) | is.na(Bsmt.Qual) | is.na(Garage.Qual)))[[0]]
model7 <- lm(lprice ~ Overall.Qual + Overall.Cond, data=ames_train)
ames_train$model7_predicted = model7$fitted.values
ames_train %>% group_by(MS.SubClass) %>% summarise(median = median(model7_predicted)) %>% arrange(desc(median))
lm.influence(model7)
hatvalues(model7)
ames_train$model7_leverage <- hatvalues(model7)
ames_train[which(ames_train$model7_leverage == max(ames_train$model7_leverage))]
which(ames_train$model7_leverage == max(ames_train$model7_leverage))
ames_train %>% group_by(Sale.Condition) %>% summarise(percent = n()/1000)
ames_train %>% filter(Sale.Condition == "Normal") %>% group_by(Sale.Condition) %>% summarise(percent = n()/1000)
model12 <- lm(lprice ~ larea, data=ames_train %>% filter(Sale.Condition == "Normal"))
model12
summary(model12)
summary(model3)
summary(model12)
